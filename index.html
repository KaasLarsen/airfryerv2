<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <title>Opskrifter i airfryer – Opskrift-Airfryer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Find lækre airfryeropskrifter – nemt, sprødt og perfekt hver gang.">
  <link rel="stylesheet" href="assets/styles.css" />

  <!-- Ekstra: animation + sticky + kort-styling til søgeresultater -->
  <style>
    /* Fade-in animation */
    .fade-in {
      opacity: 0;
      transform: translateY(8px);
      animation: fadeIn 0.3s ease-out forwards;
    }
    @keyframes fadeIn {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Sticky søgefelt */
    .hero-large-search.sticky {
      position: sticky;
      top: 12px;
      z-index: 50;
      background: rgba(255,255,255,0.94);
      backdrop-filter: blur(6px);
      border-radius: 12px;
      padding: 0.4rem 0.9rem;
      box-shadow: 0 4px 14px rgba(0,0,0,0.12);
    }

    /* Kort-styling til søgeresultater – samme look som på /sider/opskrifter */
    .category-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 1.75rem;
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem;
    }

    .category-card {
      border: 1px solid #e5e5e5;
      border-radius: 14px;
      background: #fff;
      overflow: hidden;
      transition: transform .15s ease, box-shadow .15s ease;
    }

    .category-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 14px rgba(0,0,0,0.10);
    }

    .category-card-image img {
      display: block;
      width: 100%;
      aspect-ratio: 1/1;
      object-fit: cover;
      background: #fafafa;
    }

    .category-card-body {
      padding: 1rem;
    }

    .category-card-title {
      font-size: 1.05rem;
      margin: 0;
      font-weight: 600;
      color: #111;
    }

    .category-card-link {
      display: block;
      text-decoration: none;
      color: inherit;
    }
  </style>
</head>

<body>

<div data-include="icons"></div>
<div data-include="header"></div>

<!-- HERO -->
<section class="hero-large"
         style="background-image: url('assets/images/hero/sunde-airfryer-retter.jpg');">
  <div class="hero-large-overlay"></div>

  <div class="hero-large-content">
    <h1 class="hero-large-title">Opskrifter & madinspiration</h1>
    <p class="hero-large-subtitle">
      300 lækre airfryeropskrifter udviklet og testet i vores eget airfryerkøkken.
    </p>

    <!-- Søgefelt: ingen action, vi håndterer søgning i JS -->
    <form class="hero-large-search" id="frontpage-search" onsubmit="return false;">
      <input type="search" id="frontpage-search-input" placeholder="Søg efter opskrift…" />
      <button type="submit">
        <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2"
             stroke-linecap="round" stroke-linejoin="round">
          <circle cx="10" cy="10" r="7"></circle>
          <line x1="15" y1="15" x2="21" y2="21"></line>
        </svg>
      </button>
    </form>

    <button class="hero-large-filter-btn">Filtre +</button>
  </div>

  <!-- FILTER PANEL -->
  <div class="filter-panel" id="filterPanel">
    <div class="filter-header">
      <h3>Filtrér opskrifter</h3>
      <button class="filter-close" id="filterClose">✕</button>
    </div>

    <div class="filter-section">
      <h4>Kategorier</h4>
      <div class="filter-options">
        <label><input type="checkbox" value="nem-aftensmad"> Nem aftensmad</label>
        <label><input type="checkbox" value="sproede-kartofler"> Sprøde kartofler</label>
        <label><input type="checkbox" value="sund-airfryer"> Sund airfryer</label>
        <label><input type="checkbox" value="snacks-tilbehor"> Snacks & tilbehør</label>
        <label><input type="checkbox" value="morgenmad"> Morgenmad</label>
        <label><input type="checkbox" value="kyllingefavoritter"> Kyllingefavoritter</label>
        <label><input type="checkbox" value="groentsager"> Grøntsager</label>
        <label><input type="checkbox" value="tilbehor"> Tilbehør</label>
      </div>
    </div>

    <button class="filter-apply" id="filterApply">Anvend filtre</button>
  </div>

  <!-- DARK OVERLAY -->
  <div class="filter-overlay" id="filterOverlay"></div>
</section>

<!-- Søgeresultater -->
<section id="frontpage-search-results"
         class="section-category"
         style="display:none; margin-top:2.5rem; margin-bottom:2.5rem;">
  <div class="category-header">
    <h2 class="section-title">Søgeresultater</h2>
    <p class="section-desc" id="frontpage-results-count"></p>
  </div>

  <div class="category-grid" id="frontpage-results-grid"></div>

  <p id="frontpage-no-results"
     style="display:none; text-align:center; color:#666; margin-top:1.5rem;">
    Ingen opskrifter matcher din søgning.
  </p>
</section>

<!-- MAIN CONTENT -->
<main>

 <!-- Populære temaer -->
<section class="section-popular">
  <h2 class="section-title">Populære temaer</h2>

  <div class="swipe-row popular-grid">

    <a class="theme-card" href="/sider/opskrifter.html?filter=sproede-kartofler">
      <img src="assets/images/tema/sproede-kartofler-768x768.jpg" class="theme-img-round" alt="Sprøde kartofler">
      <h3>Sprøde kartofler</h3>
      <p class="theme-meta"
         data-category="sproede-kartofler"
         data-aliases="sproede-kartofler,kartofler,tilbehør,tilbehoer,tilbehor">–</p>
    </a>

    <a class="theme-card" href="/sider/opskrifter.html?filter=kyllingefavoritter">
      <img src="assets/images/tema/kyllingefavoritter-768x768.jpg" class="theme-img-round" alt="Kyllingefavoritter">
      <h3>Kyllingefavoritter</h3>
      <p class="theme-meta"
         data-category="kyllingefavoritter"
         data-aliases="kyllingefavoritter,kylling,fjerkrae">–</p>
    </a>

    <a class="theme-card" href="/sider/opskrifter.html?filter=nem-aftensmad">
      <img src="assets/images/tema/nem-aftensmad-768x768.jpg" class="theme-img-round" alt="Nem aftensmad">
      <h3>Nem aftensmad</h3>
      <p class="theme-meta"
         data-category="nem-aftensmad"
         data-aliases="nem-aftensmad,hovedret">–</p>
    </a>

    <a class="theme-card" href="/sider/opskrifter.html?filter=snacks-tilbehor">
      <img src="assets/images/tema/snacks-tilbehor-768x768.jpg" class="theme-img-round" alt="Snacks & tilbehør">
      <h3>Snacks & tilbehør</h3>
      <p class="theme-meta"
         data-category="snacks-tilbehor"
         data-aliases="snacks-tilbehor,snack,snacks,tilbehør,tilbehoer,tilbehor">–</p>
    </a>

    <a class="theme-card" href="/sider/opskrifter.html?filter=sund-airfryer">
      <img src="assets/images/tema/sund-airfryer-768x768.jpg" class="theme-img-round" alt="Sundere airfryer-retter">
      <h3>Sundere airfryer-retter</h3>
      <p class="theme-meta"
         data-category="sund-airfryer"
         data-aliases="sund-airfryer,sund,protein,groentsager,grøntsager,vegetar">–</p>
    </a>

    <a class="theme-card" href="/sider/opskrifter.html?filter=morgenmad">
      <img src="assets/images/tema/morgenmad-airfryer-768x768.jpg" class="theme-img-round" alt="Morgenmad i airfryer">
      <h3>Morgenmad i airfryer</h3>
      <p class="theme-meta"
         data-category="morgenmad"
         data-aliases="morgenmad,aeg,æg">–</p>
    </a>

    <a class="theme-card" href="/sider/opskrifter.html?filter=bagvaerk">
      <img src="assets/images/tema/bagvaerk-soede-sager-768x768.jpg" class="theme-img-round" alt="Bagværk & søde sager">
      <h3>Bagværk & søde sager</h3>
      <p class="theme-meta"
         data-category="bagvaerk"
         data-aliases="bagvaerk,broed,dessert,madpakke">–</p>
    </a>

  </div>
</section>




  <script>
  document.addEventListener("DOMContentLoaded", async () => {
    const res = await fetch("/assets/recipes.json");
    const data = await res.json();
    const recipes = data.recipes || [];

    document.querySelectorAll(".theme-meta").forEach(meta => {
      const cat = meta.dataset.category;
      const count = recipes.filter(r => r.categories && r.categories.includes(cat)).length;
      meta.textContent = `${count} opskrifter`;
    });
  });
  </script>

  <!-- SUNDE OPSKRIFTER HEADER -->
  <section class="section-category jule-header">
    <div class="category-header">
      <h2 class="section-title">Sunde opskrifter</h2>

      <div class="category-links">
        <a href="/sider/opskrifter.html?filter=sund-airfryer">Sund airfryer</a><span>|</span>
        <a href="/sider/opskrifter.html?filter=kyllingefavoritter">Kylling</a><span>|</span>
        <a href="/sider/opskrifter.html?filter=groentsager">Grøntsager</a><span>|</span>
        <a href="/sider/opskrifter.html?filter=fisk">Fisk</a><span>|</span>
        <a href="/sider/opskrifter.html?filter=nem-aftensmad">Nem hverdagsmad</a>
      </div>
    </div>
  </section>

  <!-- SUNDE OPSKRIFTER SLIDER -->
  <section class="slider-section">
    <div class="slider-wrapper">

      <button class="slider-btn prev">‹</button>

      <div class="recipe-slider" id="recipe-slider">

        <a href="opskrifter/kyllingebryst-i-airfryer.html" class="recipe-slide-card">
          <img src="assets/images/recipes/kyllingebryst-airfryer-768x768.jpg" alt="Kyllingebryst i airfryer">
          <h3>Kyllingebryst i airfryer</h3>
        </a>

        <a href="opskrifter/laks-i-airfryer.html" class="recipe-slide-card">
          <img src="assets/images/recipes/laks-i-airfryer-768x768.jpg" alt="Laks i airfryer">
          <h3>Laks i airfryer</h3>
        </a>

        <a href="opskrifter/kyllinge-laar-airfryer.html" class="recipe-slide-card">
          <img src="assets/images/recipes/kyllinge-laar-airfryer-768x768.jpg" alt="Kyllingelår i airfryer">
          <h3>Kyllingelår i airfryer</h3>
        </a>

        <a href="opskrifter/grillede-groentsager-airfryer.html" class="recipe-slide-card">
          <img src="assets/images/recipes/grillede-groentsager-airfryer-768x768.jpg" alt="Grillede grøntsager i airfryer">
          <h3>Grillede grøntsager i airfryer</h3>
        </a>

        <a href="opskrifter/fiskefilet.html" class="recipe-slide-card">
          <img src="assets/images/recipes/fiskefilet-768x768.jpg" alt="Fiskefilet i airfryer">
          <h3>Fiskefilet i airfryer</h3>
        </a>

        <a href="opskrifter/vegetar-tarteletter.html" class="recipe-slide-card">
          <img src="assets/images/recipes/vegetar-tarteletter-768x768.jpg" alt="Vegetar tarteletter">
          <h3>Vegetar tarteletter</h3>
        </a>

      </div>

      <button class="slider-btn next">›</button>

    </div>
  </section>

  <!-- FEATURED (SUNDERE) – LAKS -->
  <section class="featured-recipe">
    <div class="featured-grid">

      <div class="featured-image">
        <img src="assets/images/recipes/laks-i-airfryer-768x768.jpg" alt="Laks i airfryer">
      </div>

      <div class="featured-content">
        <span class="featured-badge">NY</span>

        <h2 class="featured-title">Laks i airfryer</h2>

        <div class="featured-meta">
          <span>12 min</span>
          <span>•</span>
          <span>Sund / Fisk</span>
          <span class="featured-stars">★★★★★</span>
        </div>

        <p class="featured-text">
          Laks i airfryer er en af de nemmeste “sunde genveje” i hverdagen: saftig fisk,
          sprød overflade og klar på få minutter – perfekt med grøntsager eller en frisk salat.
        </p>

        <a href="opskrifter/laks-i-airfryer.html" class="featured-btn">
          Se opskrift →
        </a>
      </div>

    </div>
  </section>

  <!-- AIRFRYER KLASSIKERE – BEHOLDES -->
  <section class="section-category">
    <div class="category-header">
      <h2 class="section-title">Airfryer klassikere</h2>

      <div class="category-links">
        <a href="#">Aftensmad</a><span>|</span>
        <a href="#">Snacks</a><span>|</span>
        <a href="#">Kylling</a><span>|</span>
        <a href="#">Kartofler</a><span>|</span>
        <a href="#">Sunde retter</a>
      </div>
    </div>
  </section>

  <section class="slider-section">
    <h2 class="section-title">Airfryer klassikere</h2>

    <div class="slider-wrapper">

      <button class="slider-btn prev">‹</button>

      <div class="recipe-slider" id="airfryer-klassikere-slider">

        <a href="opskrifter/pommes-frites.html" class="recipe-slide-card">
          <img src="assets/images/recipes/pommes-frites-768x768.jpg" alt="Pommes frites i airfryer">
          <h3>Pommes frites i airfryer</h3>
        </a>

        <a href="opskrifter/kyllinge-laar-airfryer.html" class="recipe-slide-card">
          <img src="assets/images/recipes/kyllinge-laar-airfryer-768x768.jpg" alt="Kyllingelår i airfryer">
          <h3>Kyllingelår i airfryer</h3>
        </a>

        <a href="opskrifter/kyllingebryst-i-airfryer.html" class="recipe-slide-card">
          <img src="assets/images/recipes/kyllingebryst-airfryer-768x768.jpg" alt="Kyllingebryst i airfryer">
          <h3>Kyllingebryst i airfryer</h3>
        </a>

        <a href="opskrifter/chicken-nuggets-airfryer.html" class="recipe-slide-card">
          <img src="assets/images/recipes/chicken-nuggets-airfryer-768x768.jpg" alt="Chicken nuggets i airfryer">
          <h3>Chicken nuggets i airfryer</h3>
        </a>

        <a href="opskrifter/bacon-i-airfryer.html" class="recipe-slide-card">
          <img src="assets/images/recipes/bacon-airfryer-768x768.jpg" alt="Bacon i airfryer">
          <h3>Bacon i airfryer</h3>
        </a>

        <a href="opskrifter/hvidloegsbroed-airfryer.html" class="recipe-slide-card">
          <img src="assets/images/recipes/hvidloegsbroed-airfryer-768x768.jpg" alt="Hvidløgsbrød i airfryer">
          <h3>Hvidløgsbrød i airfryer</h3>
        </a>

        <a href="opskrifter/laks-i-airfryer.html" class="recipe-slide-card">
          <img src="assets/images/recipes/laks-i-airfryer-768x768.jpg" alt="Laks i airfryer">
          <h3>Laks i airfryer</h3>
        </a>

        <a href="opskrifter/kyllingevinger-i-airfryer.html" class="recipe-slide-card">
          <img src="assets/images/recipes/kyllingevinger-i-airfryer-768x768.jpg" alt="Kyllingevinger i airfryer">
          <h3>Kyllingevinger i airfryer</h3>
        </a>

      </div>

      <button class="slider-btn next">›</button>

    </div>
  </section>

  <!-- FEATURED (SUNDERE) – GRILLEDE GRØNTSAGER (erstatning for soltørrede tomater) -->
  <section class="featured-recipe">
    <div class="featured-grid featured-grid--reverse">

      <div class="featured-content">
        <span class="featured-badge">NY</span>

        <h2 class="featured-title">Grillede grøntsager i airfryer</h2>

        <div class="featured-meta">
          <span>18 min</span>
          <span>•</span>
          <span>Sund / Tilbehør</span>
          <span class="featured-stars">★★★★★</span>
        </div>

        <p class="featured-text">
          Grillede grøntsager i airfryer er den nemmeste måde at få mere grønt ind i hverdagen:
          sprød kant, masser af smag og klar på under 20 minutter – perfekt som tilbehør eller let aftensmad.
        </p>

        <a href="opskrifter/grillede-groentsager-airfryer.html" class="featured-btn">
          Se opskrift →
        </a>
      </div>

      <div class="featured-image">
        <img src="assets/images/recipes/grillede-groentsager-airfryer-768x768.jpg"
             alt="Grillede grøntsager i airfryer">
      </div>

    </div>
  </section>

  <!-- PRICERUNNER FULL-WIDTH HERO SLIDER -->
  <section class="section-category pricerunner-hero-section">
    <div class="category-header">
      <h2 class="section-title">Udvalgte airfryere</h2>
    </div>

    <div class="pricerunner-hero-wrapper">

      <button class="slider-btn pricerunner-hero-prev">‹</button>

      <div class="pricerunner-hero-slider" id="pricerunnerHeroSlider">

        <div class="pricerunner-hero-slide">
          <div id="pr-product-widget-da8ffb40" style="width:100%"></div>
          <script src="https://api.pricerunner.com/publisher-widgets/dk/product.js?onlyInStock=true&offerOrigin=NATIONAL&offerLimit=3&productId=3208440524&partnerId=adrunner_dk_opskrift-airfryer&widgetId=pr-product-widget-da8ffb40" async></script>
        </div>

        <div class="pricerunner-hero-slide">
          <div id="pr-product-widget-f25f68f0" style="width:100%"></div>
          <script src="https://api.pricerunner.com/publisher-widgets/dk/product.js?onlyInStock=true&offerOrigin=NATIONAL&offerLimit=3&productId=3231353404&partnerId=adrunner_dk_opskrift-airfryer&widgetId=pr-product-widget-f25f68f0" async></script>
        </div>

        <div class="pricerunner-hero-slide">
          <div id="pr-product-widget-18227690" style="width:100%"></div>
          <script src="https://api.pricerunner.com/publisher-widgets/dk/product.js?onlyInStock=true&offerOrigin=NATIONAL&offerLimit=3&productId=3405103592&partnerId=adrunner_dk_opskrift-airfryer&widgetId=pr-product-widget-18227690" async></script>
        </div>

      </div>

      <button class="slider-btn pricerunner-hero-next">›</button>

    </div>

    <p class="pricerunner-note">
      Annonce i samarbejde med <strong>PriceRunner</strong>
    </p>
  </section>

</main>

<div data-include="footer"></div>
<div data-include="analytics"></div>

<script src="assets/include.js" defer></script>
<script src="assets/header.js" defer></script>

<!-- SLIDER JS (første slider) -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const slider = document.getElementById("recipe-slider");
  const btnPrev = document.querySelector(".slider-btn.prev");
  const btnNext = document.querySelector(".slider-btn.next");

  if (btnPrev && btnNext && slider) {
    btnPrev.addEventListener("click", () => slider.scrollBy({ left: -320, behavior: "smooth" }));
    btnNext.addEventListener("click", () => slider.scrollBy({ left: 320, behavior: "smooth" }));
  }
});
</script>

<!-- Kategori-count -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  fetch("/assets/recipes.json")
    .then(r => r.json())
    .then(data => {
      const counts = {};
      const recipes = data.recipes || [];

      recipes.forEach(recipe => {
        (recipe.categories || []).forEach(cat => {
          counts[cat] = (counts[cat] || 0) + 1;
        });
      });

      document.querySelectorAll("[data-category]").forEach(el => {
        const cat = el.dataset.category;
        const amount = counts[cat] || 0;
        el.textContent = amount + " opskrifter";
      });
    })
    .catch(err => console.error("FEJL:", err));
});
</script>

<!-- FORSIDE-LIVE-SØGNING -->
<script>
let FP_ALL_RECIPES = [];

async function fpLoadRecipes() {
  if (FP_ALL_RECIPES.length) return;
  const res = await fetch("/assets/recipes.json");
  const data = await res.json();
  FP_ALL_RECIPES = data.recipes || [];
}

document.addEventListener("DOMContentLoaded", async () => {
  await fpLoadRecipes();

  const input = document.getElementById("frontpage-search-input");
  const searchForm = document.getElementById("frontpage-search");
  const section = document.getElementById("frontpage-search-results");
  const grid = document.getElementById("frontpage-results-grid");
  const count = document.getElementById("frontpage-results-count");
  const noResults = document.getElementById("frontpage-no-results");

  window.addEventListener("scroll", () => {
    if (window.scrollY > 120) searchForm.classList.add("sticky");
    else searchForm.classList.remove("sticky");
  });

  input.addEventListener("input", () => {
    const q = input.value.trim().toLowerCase();

    if (q.length < 2) {
      section.style.display = "none";
      return;
    }

    const matches = FP_ALL_RECIPES.filter(r =>
      r.title.toLowerCase().includes(q) ||
      (r.categories || []).join(" ").toLowerCase().includes(q)
    );

    grid.innerHTML = "";

    section.classList.remove("fade-in");
    void section.offsetWidth;
    section.classList.add("fade-in");

    if (!matches.length) {
      count.textContent = "";
      noResults.style.display = "block";
      section.style.display = "block";
      return;
    }

    noResults.style.display = "none";
    count.textContent = `Vi fandt ${matches.length} opskrifter`;

    matches.slice(0, 12).forEach(r => {
      const img = r.image
        ? `/assets/images/recipes/${r.image}`
        : `/assets/images/recipes/placeholder.jpg`;

      grid.insertAdjacentHTML("beforeend", `
        <article class="category-card fade-in">
          <a class="category-card-link" href="/opskrifter/${r.slug}.html">
            <div class="category-card-image">
              <img src="${img}" alt="${r.title}" loading="lazy">
            </div>
            <div class="category-card-body">
              <h3 class="category-card-title">${r.title}</h3>
            </div>
          </a>
        </article>
      `);
    });

    section.style.display = "block";
  });
});
</script>

<!-- Filterpanel -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const openBtn = document.querySelector(".hero-large-filter-btn");
  const panel = document.getElementById("filterPanel");
  const overlay = document.getElementById("filterOverlay");
  const closeBtn = document.getElementById("filterClose");
  const applyBtn = document.getElementById("filterApply");

  function closePanel() {
    panel.classList.remove("open");
    overlay.classList.remove("open");
  }

  if (openBtn) {
    openBtn.addEventListener("click", () => {
      panel.classList.add("open");
      overlay.classList.add("open");
    });
  }

  if (closeBtn) closeBtn.addEventListener("click", closePanel);
  if (overlay) overlay.addEventListener("click", closePanel);

  if (applyBtn) {
    applyBtn.addEventListener("click", () => {
      const selected = Array.from(panel.querySelectorAll("input[type='checkbox']:checked"))
        .map(cb => cb.value);

      if (selected.length > 0) {
        const query = selected.join(",");
        window.location.href = `/sider/opskrifter.html?filter=${query}`;
      } else {
        window.location.href = `/sider/opskrifter.html`;
      }

      closePanel();
    });
  }
});
</script>

<!-- PriceRunner hero slider -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const slider = document.getElementById("pricerunnerHeroSlider");
  if (!slider) return;

  const slides = slider.children;
  const total = slides.length;

  let index = 0;
  let autoplaySpeed = 6000;

  function updateSlider() {
    slider.style.transform = `translateX(-${index * 100}%)`;
  }

  const prev = document.querySelector(".pricerunner-hero-prev");
  const next = document.querySelector(".pricerunner-hero-next");

  if (prev) prev.addEventListener("click", () => {
    index = (index - 1 + total) % total;
    updateSlider();
  });

  if (next) next.addEventListener("click", () => {
    index = (index + 1) % total;
    updateSlider();
  });

  setInterval(() => {
    index = (index + 1) % total;
    updateSlider();
  }, autoplaySpeed);
});
</script>

<div data-include="cookie-banner"></div>

<!-- Mobile touch-fix -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll(".theme-card").forEach(card => {
    card.addEventListener("touchend", e => {
      e.preventDefault();
      e.stopPropagation();
      window.location.href = card.getAttribute("href");
    }, { passive: false });

    card.addEventListener("click", () => {
      window.location.href = card.getAttribute("href");
    });
  });
});
</script>
<script>
(() => {
  const RECIPES_URL = "/assets/data/recipes.json"; // Hvis din json ligger et andet sted, så ret kun denne.

  const norm = s => String(s || "").trim().toLowerCase();

  fetch(RECIPES_URL)
    .then(r => r.json())
    .then(data => {
      const recipes = data.recipes || [];

      document.querySelectorAll(".theme-meta[data-category]").forEach(el => {
        const aliasesRaw = el.getAttribute("data-aliases") || el.getAttribute("data-category") || "";
        const aliases = aliasesRaw.split(",").map(norm).filter(Boolean);

        const count = recipes.filter(rec => {
          const cats = (rec.categories || []).map(norm);
          return aliases.some(a => cats.includes(a));
        }).length;

        el.textContent = `${count} opskrifter`;
      });
    })
    .catch(() => {
      // Hvis fetch fejler, så lad bare '-' stå, så du tydeligt kan se at noget ikke loader.
    });
})();
</script>
<script>
(function () {
  const RECIPES_URL = "/assets/data/recipes.json"; // ret kun denne hvis din sti er anderledes
  const norm = (s) => String(s || "").trim().toLowerCase();

  function runPopularCounts(recipes) {
    document.querySelectorAll(".theme-meta[data-category]").forEach((el) => {
      const aliasesRaw = el.getAttribute("data-aliases") || el.getAttribute("data-category") || "";
      const aliases = aliasesRaw.split(",").map(norm).filter(Boolean);

      const count = recipes.filter((r) => {
        const cats = (r.categories || []).map(norm);
        return aliases.some((a) => cats.includes(a));
      }).length;

      el.textContent = `${count} opskrifter`;
    });
  }

  function boot() {
    fetch(RECIPES_URL)
      .then((r) => r.json())
      .then((data) => {
        const recipes = data.recipes || [];

        // Kør flere gange, så vi “vinder” over eventuelle gamle scripts der overskriver bagefter
        runPopularCounts(recipes);
        setTimeout(() => runPopularCounts(recipes), 150);
        setTimeout(() => runPopularCounts(recipes), 600);
      })
      .catch(() => {
        // behold '-' hvis fetch fejler
      });
  }

  window.addEventListener("load", boot);
})();
</script>

</body>
</html>

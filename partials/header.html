<header class="site-header">
  <div class="header-inner">

    <!-- LOGO -->
    <div class="header-logo">
      <a href="/">Opskrift-Airfryer</a>
    </div>

    <!-- MENU -->
    <nav class="header-nav">
      <a href="/">Forside</a>
      <a href="/opskrifter.html">Opskrifter</a>
      <a href="/madplaner.html">Madplaner</a>
    </nav>

    <!-- ACTION ICONS -->
    <div class="header-actions">

      <!-- SØG IKON -->
      <button class="header-icon" id="openSearch">
        <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"
             stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="7"></circle>
          <line x1="16" y1="16" x2="22" y2="22"></line>
        </svg>
      </button>

      <!-- ❤️ GEMTE OPSKRIFTER -->
      <button class="header-icon" id="openSaved">
        <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"
             stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 21s-6.3-4.2-9.3-8.1C-1.2 7 2 2 6.5 2c2.3 0 4 1.2 5.5 3 1.5-1.8 3.2-3 5.5-3C22 2 25.2 7 21.3 12.9C18.3 16.8 12 21 12 21z"/>
        </svg>
      </button>

    </div>
  </div>

  <!-- SØGEBAR -->
  <div class="header-searchbar" id="searchBar">
    <form action="/search.html" method="get">
      <input type="search" name="q" placeholder="Søg efter opskrifter…" />
    </form>
  </div>
</header>

<!-- FAVORIT PANEL -->
<div class="saved-drawer">
  <div class="saved-drawer-inner">

    <div class="saved-drawer-header">
      <h2>Gemte opskrifter</h2>
      <button id="closeSaved" class="close-btn">×</button>
    </div>

    <!-- SLET ALLE -->
    <button id="clearSaved" class="clear-saved-btn">Slet alle</button>

    <div class="saved-drawer-list" id="savedList">
      <p class="empty-text">Du har ingen gemte opskrifter endnu ❤️</p>
    </div>

  </div>
</div>

<script>
(function () {

  /*** ELEMENTER ***/
  const searchBtn  = document.getElementById("openSearch");
  const searchBar  = document.getElementById("searchBar");
  const openSaved  = document.getElementById("openSaved");
  const closeSaved = document.getElementById("closeSaved");
  const drawer     = document.querySelector(".saved-drawer");
  const listEl     = document.getElementById("savedList");
  const clearBtn   = document.getElementById("clearSaved");


  /*** SØGEFELT ***/
  if (searchBtn && searchBar) {
    searchBtn.addEventListener("click", () => {
      searchBar.style.display = searchBar.style.display === "block" ? "none" : "block";
    });
  }


  /*** STORAGE HELPERS ***/
  function getSavedRaw() {
    try { return JSON.parse(localStorage.getItem("savedRecipes") || "[]"); }
    catch (e) { return []; }
  }

  function saveAll(arr) {
    localStorage.setItem("savedRecipes", JSON.stringify(arr));
  }


  /*** RENDER LISTE ***/
  function renderSavedList() {
    if (!listEl) return;

    const saved = getSavedRaw();

    if (saved.length === 0) {
      listEl.innerHTML = '<p class="empty-text">Du har ingen gemte opskrifter endnu ❤️</p>';
      return;
    }

    listEl.innerHTML = saved.map(item => `
      <div class="saved-item">
        <a href="${item.url}">
          <img src="${item.image}" alt="${item.title}">
        </a>

        <div class="saved-item-info">
          <a class="saved-item-title" href="${item.url}">${item.title}</a>
        </div>

        <!-- ❌ FJERN ENKELT OPSKRIFT -->
        <button class="remove-saved-item" data-title="${item.title}">✖</button>
      </div>
    `).join("");

    // Klik på "✖"
    document.querySelectorAll(".remove-saved-item").forEach(btn => {
      btn.addEventListener("click", () => {
        const title = btn.dataset.title;
        let saved = getSavedRaw();
        saved = saved.filter(item => item.title !== title);
        saveAll(saved);
        renderSavedList();
      });
    });
  }


  /*** ÅBN / LUK PANEL ***/
  if (openSaved) {
    openSaved.addEventListener("click", () => {
      drawer.classList.add("open");
      renderSavedList();
    });
  }

  if (closeSaved) {
    closeSaved.addEventListener("click", () => drawer.classList.remove("open"));
  }

  /*** LUK VED KLIK UDENFOR ***/
  document.addEventListener("click", (e) => {
    if (!drawer.classList.contains("open")) return;
    if (drawer.contains(e.target)) return;
    if (openSaved.contains(e.target)) return;
    drawer.classList.remove("open");
  });


  /*** SLET ALLE ***/
  if (clearBtn) {
    clearBtn.addEventListener("click", () => {
      if (confirm("Slet alle gemte opskrifter?")) {
        saveAll([]);
        renderSavedList();
      }
    });
  }

})();
</script>

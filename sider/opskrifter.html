<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <title>Alle opskrifter i airfryer – Opskrift-Airfryer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description"
        content="Se alle vores airfryeropskrifter samlet ét sted. Søg, filtrér og find præcis den opskrift du leder efter.">

  <link rel="stylesheet" href="../assets/styles.css" />
</head>

<body>

<div data-include="icons"></div>
<div data-include="header"></div>

<!-- HERO som forsiden -->
<section class="hero-large"
         style="background-image: url('../assets/images/hero/hero-julebord-airfryer-1920x1080.jpg');">
  <div class="hero-large-overlay"></div>

  <div class="hero-large-content">

    <h1 class="hero-large-title">alle opskrifter i airfryer</h1>

    <p class="hero-large-subtitle">
      Scroll gennem alle opskrifter eller brug søgning og kategorier for at finde præcis det, du leder efter.
    </p>

    <form class="hero-large-search" id="recipe-search-form">
      <input type="search" id="recipe-search" placeholder="Søg på opskrift, ingrediens eller kategori …" />
      <button type="submit">
        <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="10" cy="10" r="7"></circle>
          <line x1="15" y1="15" x2="21" y2="21"></line>
        </svg>
      </button>
    </form>

  </div>
</section>


<main>

  <!-- KATEGORIER UNDER HERO -->
  <section class="section-category" id="recipe-categories">
    <div class="filter-bar-inner">
      <div class="filter-buttons">
        <button class="filter-btn is-active" data-filter="Alle">Alle</button>
        <button class="filter-btn" data-filter="sproede-kartofler">Sprøde kartofler</button>
        <button class="filter-btn" data-filter="kyllingefavoritter">Kylling</button>
        <button class="filter-btn" data-filter="nem-aftensmad">Aftensmad</button>
        <button class="filter-btn" data-filter="snacks-tilbehor">Snacks & tilbehør</button>
        <button class="filter-btn" data-filter="sund-airfryer">Sundere</button>
        <button class="filter-btn" data-filter="morgenmad">Morgenmad</button>
        <button class="filter-btn" data-filter="bagvaerk">Bagværk</button>
        <button class="filter-btn" data-filter="jul">Jul</button>
      </div>
    </div>
  </section>

  <!-- OPSKRIFTSGRID -->
  <section class="section-category" style="margin-top:2.5rem; margin-bottom:3rem;">
    <div class="category-header">
      <h2 class="section-title">alle opskrifter</h2>
      <p class="section-desc" id="recipes-count">Indlæser opskrifter …</p>
    </div>

    <div class="category-grid" id="recipes-grid"></div>

    <div id="recipes-empty-state" style="display:none; text-align:center; margin-top:2rem;">
      Ingen opskrifter matcher dine filtre.
    </div>
  </section>

</main>

<div data-include="footer"></div>

<script src="../assets/include.js" defer></script>
<script src="../assets/header.js" defer></script>

<!-- HENTER recipes.json - KORREKT STI! -->
<script>
let ALL_RECIPES = [];

async function loadRecipes() {
  const res = await fetch("/assets/recipes.json");  // ← RETTET
  const data = await res.json();
  ALL_RECIPES = [...data.recipes].reverse();
}
</script>

<!-- FILTER + SØGNING -->
<script>
document.addEventListener("DOMContentLoaded", async () => {

  await loadRecipes();

  const grid = document.getElementById("recipes-grid");
  const countEl = document.getElementById("recipes-count");
  const searchInput = document.getElementById("recipe-search");
  const filterButtons = document.querySelectorAll(".filter-btn");

  let activeFilter = "Alle";
  let searchQuery = "";

  function render(list) {
    grid.innerHTML = "";

    if (!list.length) {
      document.getElementById("recipes-empty-state").style.display = "block";
      return;
    }

    document.getElementById("recipes-empty-state").style.display = "none";

    list.forEach(r => {
      grid.innerHTML += `
        <article class="category-card">
          <a class="category-card-link" href="./${r.slug}.html">
            <div class="category-card-image">
              <img src="../assets/images/recipes/${r.slug}-768x768.jpg" alt="${r.title}">
            </div>
            <div class="category-card-body">
              <h3 class="category-card-title">${r.title}</h3>
            </div>
          </a>
        </article>`;
    });

    countEl.textContent = \`Viser \${list.length} opskrifter\`;
  }

  function applyFilters() {
    const q = searchQuery.toLowerCase();

    const filtered = ALL_RECIPES.filter(r => {
      const cats = r.categories.join(" ").toLowerCase();
      const title = r.title.toLowerCase();

      const inCat = activeFilter === "Alle" || r.categories.includes(activeFilter);
      const inSearch = !q || title.includes(q) || cats.includes(q);

      return inCat && inSearch;
    });

    render(filtered);
  }

  filterButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      filterButtons.forEach(b => b.classList.remove("is-active"));
      btn.classList.add("is-active");
      activeFilter = btn.dataset.filter;
      applyFilters();
    });
  });

  searchInput.addEventListener("input", () => {
    searchQuery = searchInput.value;
    applyFilters();
  });

  applyFilters();
});
</script>

</body>
</html>

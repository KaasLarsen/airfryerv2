<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <title>Opskrifter i airfryer – alle opskrifter</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- ✔️ KORREKT STILSTI -->
  <link rel="stylesheet" href="../assets/styles.css" />
</head>

<body>

  <!-- ✔️ KORREKT INCLUDE PATH HÅNDTERES VIA include.js -->
  <div data-include="../header"></div>

  <main>
    <article class="page-recipes">

      <!-- HERO -->
      <section class="hero hero-inner">
        <div class="hero-inner-content">
          <p class="hero-kicker">alle opskrifter</p>
          <h1 class="hero-title">Opskrifter i airfryer</h1>
          <p class="hero-lead">Her finder du alle opskrifter samlet ét sted.</p>
        </div>
      </section>

      <!-- FILTER -->
      <section class="filter-bar">
        <div class="filter-bar-inner">
          <span class="filter-label">Filtrér:</span>
          <div class="filter-buttons">
            <button class="filter-btn is-active" data-filter="Alle">Alle</button>
            <button class="filter-btn" data-filter="sproede-kartofler">Sprøde kartofler</button>
            <button class="filter-btn" data-filter="kyllingefavoritter">Kylling</button>
            <button class="filter-btn" data-filter="nem-aftensmad">Aftensmad</button>
            <button class="filter-btn" data-filter="snacks-tilbehor">Snacks & tilbehør</button>
            <button class="filter-btn" data-filter="morgenmad">Morgenmad</button>
            <button class="filter-btn" data-filter="jul">Jul</button>
            <button class="filter-btn" data-filter="sund-airfryer">Sund</button>
          </div>
        </div>
      </section>

      <!-- GRID -->
      <section class="section-category" style="margin-top:2.5rem; margin-bottom:3rem;">
        <div class="category-header">
          <div>
            <h2 class="section-title">Alle opskrifter</h2>
            <p class="section-desc" id="recipes-count">Indlæser opskrifter...</p>
          </div>
        </div>

        <div id="recipes-grid" class="category-grid"></div>

        <div id="recipes-empty-state" style="display:none; text-align:center; color:#666; margin-top:1rem;">
          Ingen opskrifter matcher filtrene.
        </div>
      </section>

    </article>
  </main>

  <div data-include="../footer"></div>

  <!-- ✔ KORREKT INCLUDE SCRIPT -->
  <script src="../assets/include.js" defer></script>

  <!-- LOAD RECIPES.JSON -->
  <script>
    let ALL_RECIPES = [];

    async function loadRecipes() {
      const res = await fetch("../assets/recipes.json");
      const data = await res.json();

      ALL_RECIPES = data.recipes.map(r => ({
        slug: r.slug,
        title: r.title,
        url: `./${r.slug}.html`,
        image: `../assets/images/recipes/${r.slug}-768x768.jpg`,
        categories: r.categories
      }));
    }
  </script>

  <!-- RENDER LOGIK -->
  <script>
    document.addEventListener("DOMContentLoaded", async () => {

      await loadRecipes();

      const grid = document.querySelector("#recipes-grid");
      const count = document.querySelector("#recipes-count");
      const empty = document.querySelector("#recipes-empty-state");
      const filterButtons = document.querySelectorAll(".filter-btn");

      let activeFilter = "Alle";

      function render(list) {
        grid.innerHTML = "";

        if (!list.length) {
          empty.style.display = "block";
          count.textContent = "Ingen opskrifter fundet.";
          return;
        }

        empty.style.display = "none";

        list.forEach(r => {
          const el = document.createElement("article");
          el.className = "category-card";
          el.innerHTML = `
            <a href="${r.url}" class="category-card-link">
              <div class="category-card-image">
                <img src="${r.image}" alt="${r.title}">
              </div>
              <div class="category-card-body">
                <h3 class="category-card-title">${r.title}</h3>
              </div>
            </a>`;
          grid.appendChild(el);
        });

        count.textContent = \`Viser \${list.length} opskrifter\`;
      }

      function applyFilter() {
        const filtered =
          activeFilter === "Alle"
            ? ALL_RECIPES
            : ALL_RECIPES.filter(r => r.categories.includes(activeFilter));

        render(filtered);
      }

      filterButtons.forEach(btn => {
        btn.addEventListener("click", () => {
          filterButtons.forEach(b => b.classList.remove("is-active"));
          btn.classList.add("is-active");
          activeFilter = btn.dataset.filter;
          applyFilter();
        });
      });

      render(ALL_RECIPES);
    });
  </script>

</body>
</html>
